{% trans_default_domain 'sfs_mailer_bundle' %}
{% extends '@SfsMailer/admin_layout.html.twig' %}

{% block title %}{{ 'admin.history.list.header_title'|trans }}{% endblock title %}

{% block content %}
    <div class="d-flex align-items-center justify-content-between mb-4">
        <h1 class="h3">{{ 'admin.history.list.title'|trans }}</h1>
        <a href="{{ url('sfs_mailer_send_spool') }}" class="btn btn-primary mb-3">Send spool now</a>
    </div>

    {% embed '@SfsAdmin/components/table.html.twig' with {'collection':mails} %}
        {% trans_default_domain 'sfs_mailer_bundle' %}
        {% block ths %}
            <th scope="col">{{ 'admin.history.list.table.date.header'|trans }}</th>
            <th scope="col">{{ 'admin.history.list.table.templateId.header'|trans }}</th>
            <th scope="col">{{ 'admin.history.list.table.to.header'|trans }}</th>
            <th scope="col">{{ 'admin.history.list.table.subject.header'|trans }}</th>
            <th scope="col">{{ 'admin.history.list.table.from.header'|trans }}</th>
            <th scope="col">{{ 'admin.history.list.table.status.header'|trans }}</th>
            <th scope="col"></th>
        {% endblock ths %}

        {% block tbody %}
            {% for mail in mails %}
                <tr>
                    <td>{{ mail.messageDate|date('H:i d-m-Y') }}</td>
                    <td>{{ mail.templateId|trans }}</td>
                    <td>{{ mail.messageTo|keys|join(',') }}</td>
                    <td>{{ mail.messageSubject }}</td>
                    <td>{{ mail.messageFrom|keys|join(',') }}</td>
                    <td>{{ ('message.status.values.'~mail.status)|trans }}</td>
                    <td class="actions text-right">
                        <a href="{{ url('sfs_mailer_history_details', {'messageId': mail.id}) }}" class="text-nowrap">{{ 'admin.history.list.table.details.link'|trans }} <span class="mdi mdi-18px mdi-eye-outline align-middle"></span></a>
                    </td>
                </tr>
            {% endfor %}
        {% endblock tbody %}
    {% endembed %}
{% endblock content %}